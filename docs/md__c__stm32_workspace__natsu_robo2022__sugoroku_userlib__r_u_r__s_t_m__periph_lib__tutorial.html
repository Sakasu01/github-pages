<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RUR_NatsuRobo2022: RUR_STM_PeriphLib Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RUR_NatsuRobo2022
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">RUR_STM_PeriphLib Tutorial </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >例として示すコードは基本的にF4のものです</p>
<h1><a class="anchor" id="autotoc_md722"></a>
基本的なペリフェラルを使う</h1>
<p >各ペリフェラルのクラスはそのクラスのマイコンごとの実装をテンプレート引数にとります</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classperipheral_1_1_g_p_i_o.html">peripheral::GPIO&lt;F4::GPIOMethod&gt;</a> hoge;</div>
<div class="ttc" id="aclassperipheral_1_1_g_p_i_o_html"><div class="ttname"><a href="classperipheral_1_1_g_p_i_o.html">peripheral::GPIO</a></div><div class="ttdoc">GPIOピンの入出力を操作するクラス</div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___s_t_m___periph_lib_2periph_2_g_p_i_o_8hpp_source.html#l00117">GPIO.hpp:117</a></div></div>
</div><!-- fragment --><p >ペリフェラルに関する列挙型はペリフェラル名の小文字の名前空間に属しています</p>
<p >また、各クラスからもアクセスできます</p>
<div class="fragment"><div class="line"><a class="code hl_enumvalue" href="namespaceperipheral_1_1gpio.html#ad225668bde900c93eaff27c38e3fd2e9ac68271a63ddbc431c307beb7d2918275">peripheral::gpio::Mode::out</a>;</div>
<div class="line"><a class="code hl_class" href="classperipheral_1_1_g_p_i_o.html">peripheral::GPIO&lt;F4::GPIOMethod&gt;::Mode::in</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classperipheral_1_1_g_p_i_o.html">peripheral::GPIO&lt;F4::GPIOMethod&gt;</a> gpio(<a class="code hl_function" href="namespace_f4.html#ad991af1c22ee57d69ef5ae26e22b13dc">F4::PA0</a>);</div>
<div class="line"><span class="keyword">decltype</span>(gpio)::Mode::analog;</div>
<div class="ttc" id="anamespace_f4_html_ad991af1c22ee57d69ef5ae26e22b13dc"><div class="ttname"><a href="namespace_f4.html#ad991af1c22ee57d69ef5ae26e22b13dc">F4::PA0</a></div><div class="ttdeci">constexpr Pin PA0(GPIOA_BASE, GPIO_Pin_0)</div></div>
<div class="ttc" id="anamespaceperipheral_1_1gpio_html_ad225668bde900c93eaff27c38e3fd2e9ac68271a63ddbc431c307beb7d2918275"><div class="ttname"><a href="namespaceperipheral_1_1gpio.html#ad225668bde900c93eaff27c38e3fd2e9ac68271a63ddbc431c307beb7d2918275">peripheral::gpio::Mode::out</a></div><div class="ttdeci">@ out</div><div class="ttdoc">出力モード</div></div>
</div><!-- fragment --><p >しかし、非常に長くて鬱陶しいので各マイコンのライブラリで特殊化しています(たぶん)</p>
<div class="fragment"><div class="line"><span class="comment">// RUR_STM_F4Lib/GPIO.hpp</span></div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="namespace_f4.html#afee6c0064227f7c1da725c5c504da0e4">GPIO</a> = <a class="code hl_class" href="classperipheral_1_1_g_p_i_o.html">peripheral::GPIO&lt;F4::GPIOMethod&gt;</a>;</div>
<div class="ttc" id="anamespace_f4_html_afee6c0064227f7c1da725c5c504da0e4"><div class="ttname"><a href="namespace_f4.html#afee6c0064227f7c1da725c5c504da0e4">F4::GPIO</a></div><div class="ttdeci">peripheral::GPIO&lt; GPIOMethod &gt; GPIO</div><div class="ttdoc">クソナガ名前空間対策</div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___s_t_m___f4_lib_2_g_p_i_o_8hpp_source.html#l00053">GPIO.hpp:53</a></div></div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// RUR_STM_F4Lib/other.hpp</span></div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="namespace_f4.html#a3892ddd42816f9b6bb2aba8ed6485e39">LED</a> = <a class="code hl_class" href="classrur_1_1_l_e_d.html">rur::LED&lt;F4::GPIOMethod&gt;</a>;</div>
<div class="ttc" id="aclassrur_1_1_l_e_d_html"><div class="ttname"><a href="classrur_1_1_l_e_d.html">rur::LED</a></div><div class="ttdoc">interface::GPIOを継承してないときにマッチするやつ  正しいクラスの時はSFINAEによって下のやつにマッチする</div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___s_t_m___periph_lib_2other_2_l_e_d_8hpp_source.html#l00029">LED.hpp:29</a></div></div>
<div class="ttc" id="anamespace_f4_html_a3892ddd42816f9b6bb2aba8ed6485e39"><div class="ttname"><a href="namespace_f4.html#a3892ddd42816f9b6bb2aba8ed6485e39">F4::LED</a></div><div class="ttdeci">rur::LED&lt; GPIOMethod &gt; LED</div><div class="ttdoc">クソナガ名前空間対策</div><div class="ttdef"><b>Definition:</b> <a href="other_8hpp_source.html#l00027">other.hpp:27</a></div></div>
</div><!-- fragment --><div class="fragment"><div class="line"><a class="code hl_class" href="classperipheral_1_1_g_p_i_o.html">F4::GPIO</a> gpio(<a class="code hl_function" href="namespace_f4.html#ad991af1c22ee57d69ef5ae26e22b13dc">F4::PA0</a>);</div>
<div class="line">gpio.config(F4::GPIO::Mode::in);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classrur_1_1_l_e_d.html">F4::LED</a> led(<a class="code hl_function" href="namespace_f4.html#ad991af1c22ee57d69ef5ae26e22b13dc">F4::PA0</a>);</div>
<div class="line">led.config();</div>
</div><!-- fragment --><p >以降の例ではすべて上記のエイリアスを用いて記述しています</p>
<hr  />
<h1><a class="anchor" id="autotoc_md724"></a>
GPIO</h1>
<p >マイコンのGPIOピンの入出力を操作することができます</p>
<p >otherモジュールの <a class="el" href="classrur_1_1_l_e_d.html" title="interface::GPIOを継承してないときにマッチするやつ  正しいクラスの時はSFINAEによって下のやつにマッチする">rur::LED</a> <a class="el" href="classrur_1_1_push_sensor.html" title="periph::GPIO::Interfaceを継承してないときにマッチするやつ  正しいクラスの時はSFINAEによって下のやつにマッチする">rur::PushSensor</a> も参照してください</p>
<p >参照</p>
<ul>
<li><code><a class="el" href="classperipheral_1_1_g_p_i_o.html" title="GPIOピンの入出力を操作するクラス">peripheral::GPIO</a>&lt;Method&gt;</code></li>
</ul>
<h2><a class="anchor" id="autotoc_md725"></a>
出力</h2>
<div class="fragment"><div class="line"><span class="comment">// PA0を出力モードで初期化</span></div>
<div class="line"><a class="code hl_class" href="classperipheral_1_1_g_p_i_o.html">F4::GPIO</a> led(<a class="code hl_function" href="namespace_f4.html#ad991af1c22ee57d69ef5ae26e22b13dc">F4::PA0</a>);</div>
<div class="line">led.config(F4::GPIO::Mode::out);</div>
<div class="line"> </div>
<div class="line">led.write(<span class="keyword">true</span>); <span class="comment">// Highレベルに</span></div>
<div class="line">led.write(<span class="keyword">false</span>); <span class="comment">// Lowレベルに</span></div>
<div class="line"> </div>
<div class="line">led.toggle(); <span class="comment">// 出力を反転</span></div>
</div><!-- fragment --><p >また、otherモジュールのLEDクラスを用いることで以下のようにも記述できます</p>
<div class="fragment"><div class="line"><span class="comment">// PA0 第2引数で負論理接続されたLEDも扱える</span></div>
<div class="line"><a class="code hl_class" href="classrur_1_1_l_e_d.html">F4::LED</a> led(<a class="code hl_function" href="namespace_f4.html#ad991af1c22ee57d69ef5ae26e22b13dc">F4::PA0</a>, <span class="comment">/*true*/</span>);</div>
<div class="line">led.config();</div>
<div class="line"> </div>
<div class="line">led.on();</div>
<div class="line">led.off();</div>
<div class="line">led.toggle();</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md726"></a>
入力</h2>
<div class="fragment"><div class="line"><span class="comment">// PA0を入力モードで初期化</span></div>
<div class="line"><a class="code hl_class" href="classperipheral_1_1_g_p_i_o.html">F4::GPIO</a> button(<a class="code hl_function" href="namespace_f4.html#ad991af1c22ee57d69ef5ae26e22b13dc">F4::PA0</a>);</div>
<div class="line">button.config(F4::GPIO::Mode::in, <span class="comment">/*F4::GPIO::Pull::up*/</span>);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> state = button.read(); <span class="comment">// High:true Low:false</span></div>
</div><!-- fragment --><p >出力と同様にotherモジュールのPushSensorクラスを用いることで以下のようにも記述できます</p>
<div class="fragment"><div class="line"><span class="comment">// PA0 第2引数で負論理接続されたスイッチも扱える</span></div>
<div class="line"><a class="code hl_class" href="classrur_1_1_push_sensor.html">F4::PushSensor</a> button(<a class="code hl_function" href="namespace_f4.html#ad991af1c22ee57d69ef5ae26e22b13dc">F4::PA0</a>, <span class="comment">/*true*/</span>);</div>
<div class="line">button.config(<span class="comment">/*F4::GPIO::Pull::up*/</span>);</div>
<div class="line"><span class="keywordtype">bool</span> f = button.read();</div>
<div class="line"><span class="keywordflow">if</span> (button) { <span class="comment">// boolへの暗黙の型変換もできます</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassrur_1_1_push_sensor_html"><div class="ttname"><a href="classrur_1_1_push_sensor.html">rur::PushSensor</a></div><div class="ttdoc">periph::GPIO::Interfaceを継承してないときにマッチするやつ  正しいクラスの時はSFINAEによって下のやつにマッチする</div><div class="ttdef"><b>Definition:</b> <a href="_push_sensor_8hpp_source.html#l00024">PushSensor.hpp:24</a></div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md728"></a>
UART</h1>
<p >DMA転送を用いたUARTの送受信を行うことができます</p>
<p >出力は３種類のフォーマット指定が可能です<a class="el" href="classutil_1_1_format_outputter.html">詳細</a></p>
<p >送受信ともに内部バッファの許容量を超えた転送はできません<a class="el" href="classperipheral_1_1_u_a_r_t.html">詳細</a></p>
<p >参照</p>
<ul>
<li><code><a class="el" href="classperipheral_1_1_u_a_r_t.html" title="UARTを用いてシリアル通信をするクラス">peripheral::UART</a>&lt;Method&gt;</code></li>
<li><code><a class="el" href="classutil_1_1_format_outputter.html" title="フォーマット出力を行うCRTPクラス">util::FormatOutputter</a></code></li>
</ul>
<div class="fragment"><div class="line"><span class="comment">// uart1 Tx:PA9 Rx:PA10で初期化</span></div>
<div class="line"><a class="code hl_class" href="classperipheral_1_1_u_a_r_t.html">F4::UART</a> <a class="code hl_variable" href="namespacemother.html#a2e39e33cbdb9ec863e21cb818ec66cf2">serial</a>(<a class="code hl_variable" href="namespace_f4.html#a251db063bb6dfca5813498a4e630f71d">F4::uart1</a>);</div>
<div class="line"><a class="code hl_variable" href="namespacemother.html#a2e39e33cbdb9ec863e21cb818ec66cf2">serial</a>.<a class="code hl_function" href="classperipheral_1_1_u_a_r_t.html#ab8bef3cae83311766725310d459025c1">config</a>(<a class="code hl_function" href="namespace_f4.html#ada50592fb568bbcf954bb558319bcc8d">F4::PA9</a>, <a class="code hl_function" href="namespace_f4.html#aefc9a286f7f3a90a343b9df4860b09bb">F4::PA10</a>, <span class="comment">/*115200*/</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 出力 詳細はutil::FormatOutputterにて</span></div>
<div class="line"><a class="code hl_variable" href="namespacemother.html#a2e39e33cbdb9ec863e21cb818ec66cf2">serial</a> &lt;&lt; <span class="stringliteral">&quot;Hello &quot;</span> &lt;&lt; 123 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a class="code hl_variable" href="namespacemother.html#a2e39e33cbdb9ec863e21cb818ec66cf2">serial</a>.<a class="code hl_function" href="classutil_1_1_format_outputter.html#a407d73e30dd4455c9629286962ad3a36">print</a>(<span class="stringliteral">&quot;hoge = $\n&quot;</span>, hoge);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 受信バッファから取得(1byte)</span></div>
<div class="line">std::optional&lt;char&gt; c = <a class="code hl_variable" href="namespacemother.html#a2e39e33cbdb9ec863e21cb818ec66cf2">serial</a>.<a class="code hl_function" href="classperipheral_1_1_u_a_r_t.html#ad932fe695604b0e05356a8f4cd424a3d">read</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 受信バッファから取得(全部)</span></div>
<div class="line">std::vector&lt;char&gt; data = <a class="code hl_variable" href="namespacemother.html#a2e39e33cbdb9ec863e21cb818ec66cf2">serial</a>.<a class="code hl_function" href="classperipheral_1_1_u_a_r_t.html#a54b5ac3e1ce55028158f78ce20e3e8c6">readAllData</a>();</div>
<div class="ttc" id="aclassperipheral_1_1_u_a_r_t_html"><div class="ttname"><a href="classperipheral_1_1_u_a_r_t.html">peripheral::UART</a></div><div class="ttdoc">UARTを用いてシリアル通信をするクラス</div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___s_t_m___periph_lib_2periph_2_u_a_r_t_8hpp_source.html#l00119">UART.hpp:121</a></div></div>
<div class="ttc" id="aclassperipheral_1_1_u_a_r_t_html_a54b5ac3e1ce55028158f78ce20e3e8c6"><div class="ttname"><a href="classperipheral_1_1_u_a_r_t.html#a54b5ac3e1ce55028158f78ce20e3e8c6">peripheral::UART::readAllData</a></div><div class="ttdeci">std::vector&lt; T &gt; readAllData()</div><div class="ttdoc">受信したデータを取得する</div><div class="ttdef"><b>Definition:</b> <a href="_u_a_r_t__impl_8hpp_source.html#l00125">UART_impl.hpp:125</a></div></div>
<div class="ttc" id="aclassperipheral_1_1_u_a_r_t_html_ab8bef3cae83311766725310d459025c1"><div class="ttname"><a href="classperipheral_1_1_u_a_r_t.html#ab8bef3cae83311766725310d459025c1">peripheral::UART::config</a></div><div class="ttdeci">bool config(Pin tx, Pin rx, uint32_t baudrate=kDefaultBaudrate, std::size_t txBufferSize=kDefaultBufferSize, std::size_t rxBufferSize=kDefaultBufferSize)</div><div class="ttdoc">UARTの初期化を行う</div><div class="ttdef"><b>Definition:</b> <a href="_u_a_r_t__impl_8hpp_source.html#l00019">UART_impl.hpp:19</a></div></div>
<div class="ttc" id="aclassperipheral_1_1_u_a_r_t_html_ad932fe695604b0e05356a8f4cd424a3d"><div class="ttname"><a href="classperipheral_1_1_u_a_r_t.html#ad932fe695604b0e05356a8f4cd424a3d">peripheral::UART::read</a></div><div class="ttdeci">std::optional&lt; T &gt; read()</div><div class="ttdoc">受信したデータを取得する</div><div class="ttdef"><b>Definition:</b> <a href="_u_a_r_t__impl_8hpp_source.html#l00108">UART_impl.hpp:108</a></div></div>
<div class="ttc" id="aclassutil_1_1_format_outputter_html_a407d73e30dd4455c9629286962ad3a36"><div class="ttname"><a href="classutil_1_1_format_outputter.html#a407d73e30dd4455c9629286962ad3a36">util::FormatOutputter::print</a></div><div class="ttdeci">void print(std::string_view str)</div><div class="ttdoc">文字列を出力する</div><div class="ttdef"><b>Definition:</b> <a href="_format_outputter_8hpp_source.html#l00108">FormatOutputter.hpp:108</a></div></div>
<div class="ttc" id="anamespace_f4_html_a251db063bb6dfca5813498a4e630f71d"><div class="ttname"><a href="namespace_f4.html#a251db063bb6dfca5813498a4e630f71d">F4::uart1</a></div><div class="ttdeci">constexpr auto uart1</div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___s_t_m___f4_lib_2_u_a_r_t_8hpp_source.html#l00054">UART.hpp:54</a></div></div>
<div class="ttc" id="anamespace_f4_html_ada50592fb568bbcf954bb558319bcc8d"><div class="ttname"><a href="namespace_f4.html#ada50592fb568bbcf954bb558319bcc8d">F4::PA9</a></div><div class="ttdeci">constexpr Pin PA9(GPIOA_BASE, GPIO_Pin_9)</div></div>
<div class="ttc" id="anamespace_f4_html_aefc9a286f7f3a90a343b9df4860b09bb"><div class="ttname"><a href="namespace_f4.html#aefc9a286f7f3a90a343b9df4860b09bb">F4::PA10</a></div><div class="ttdeci">constexpr Pin PA10(GPIOA_BASE, GPIO_Pin_10)</div></div>
<div class="ttc" id="anamespacemother_html_a2e39e33cbdb9ec863e21cb818ec66cf2"><div class="ttname"><a href="namespacemother.html#a2e39e33cbdb9ec863e21cb818ec66cf2">mother::serial</a></div><div class="ttdeci">F4::UART &amp; serial</div><div class="ttdef"><b>Definition:</b> <a href="_running_board_8cpp_source.html#l00028">RunningBoard.cpp:28</a></div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md730"></a>
ADC</h1>
<p >DMA転送を用いてADCを低レイテンシに読み取ることができます</p>
<p >ADCクラスからの読みとよりも、ADC:Channelを生成して読みだしたほうが若干速いです(チャンネルの存在確認が行われないため)</p>
<p >参照</p>
<ul>
<li><code><a class="el" href="classperipheral_1_1_a_d_c.html" title="ADCクラス">peripheral::ADC</a>&lt;Method&gt;</code></li>
<li><code><a class="el" href="classperipheral_1_1_a_d_c_1_1_channel.html" title="ADCのチャンネルクラス">peripheral::ADC::Channel</a></code></li>
</ul>
<div class="fragment"><div class="line"><a class="code hl_class" href="classperipheral_1_1_a_d_c.html">F4::ADC</a> <a class="code hl_variable" href="namespacemother.html#ab6f2a3687895c34bf49fa9acdaa2c0d7">adc</a>(<a class="code hl_variable" href="namespace_f4.html#a49f4802b0785451687f484d77f0d1829">F4::adc1</a>);</div>
<div class="line"><a class="code hl_variable" href="namespacemother.html#ab6f2a3687895c34bf49fa9acdaa2c0d7">adc</a>.<a class="code hl_function" href="classperipheral_1_1_a_d_c.html#a9d9ed0614da18b7f52ce01fcc59b9c78">config</a>({<a class="code hl_define" href="group___a_d_c__channels.html#ga40ec353803e9470a5721ef5bf0b1ab24">ADC_Channel_0</a>, <a class="code hl_define" href="group___a_d_c__channels.html#ga0b04cebf8d62085eca6dc7daa3d5d3f0">ADC_Channel_1</a>}, <a class="code hl_define" href="group___a_d_c__sampling__times.html#ga7b89fd620d7f7d361a9e7af3713cca0e">ADC_SampleTime_3Cycles</a>, 1);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// すこし遅い</span></div>
<div class="line">std::optional&lt;float&gt; value1 = <a class="code hl_variable" href="namespacemother.html#ab6f2a3687895c34bf49fa9acdaa2c0d7">adc</a>.<a class="code hl_function" href="classperipheral_1_1_a_d_c.html#aef96113602ede49aee71124ef247442d">readVoltage</a>(<a class="code hl_define" href="group___a_d_c__channels.html#ga40ec353803e9470a5721ef5bf0b1ab24">ADC_Channel_0</a>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classperipheral_1_1_a_d_c_1_1_channel.html">F4::ADC::Channel</a> ch = *(<a class="code hl_variable" href="namespacemother.html#ab6f2a3687895c34bf49fa9acdaa2c0d7">adc</a>.<a class="code hl_function" href="classperipheral_1_1_a_d_c.html#a3eb481491802c74ecec2ee5ce85c96b4">createChannel</a>(<a class="code hl_define" href="group___a_d_c__channels.html#ga0b04cebf8d62085eca6dc7daa3d5d3f0">ADC_Channel_1</a>));</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">float</span> value2 = ch.<a class="code hl_function" href="classperipheral_1_1_a_d_c_1_1_channel.html#af7c1fc96abaa780afb5cecfbc6fcde68">readVoltage</a>();</div>
<div class="ttc" id="aclassperipheral_1_1_a_d_c_1_1_channel_html"><div class="ttname"><a href="classperipheral_1_1_a_d_c_1_1_channel.html">peripheral::ADC::Channel</a></div><div class="ttdoc">ADCのチャンネルクラス</div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___s_t_m___periph_lib_2periph_2_a_d_c_8hpp_source.html#l00226">ADC.hpp:226</a></div></div>
<div class="ttc" id="aclassperipheral_1_1_a_d_c_1_1_channel_html_af7c1fc96abaa780afb5cecfbc6fcde68"><div class="ttname"><a href="classperipheral_1_1_a_d_c_1_1_channel.html#af7c1fc96abaa780afb5cecfbc6fcde68">peripheral::ADC::Channel::readVoltage</a></div><div class="ttdeci">float readVoltage() const</div><div class="ttdoc">電圧の取得</div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___s_t_m___periph_lib_2periph_2_a_d_c_8hpp_source.html#l00254">ADC.hpp:254</a></div></div>
<div class="ttc" id="aclassperipheral_1_1_a_d_c_html"><div class="ttname"><a href="classperipheral_1_1_a_d_c.html">peripheral::ADC</a></div><div class="ttdoc">ADCクラス</div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___s_t_m___periph_lib_2periph_2_a_d_c_8hpp_source.html#l00099">ADC.hpp:99</a></div></div>
<div class="ttc" id="aclassperipheral_1_1_a_d_c_html_a3eb481491802c74ecec2ee5ce85c96b4"><div class="ttname"><a href="classperipheral_1_1_a_d_c.html#a3eb481491802c74ecec2ee5ce85c96b4">peripheral::ADC::createChannel</a></div><div class="ttdeci">std::optional&lt; Channel &gt; createChannel(uint8_t ch) const</div><div class="ttdoc">チャンネルオブジェクトの生成</div><div class="ttdef"><b>Definition:</b> <a href="_a_d_c__impl_8hpp_source.html#l00080">ADC_impl.hpp:80</a></div></div>
<div class="ttc" id="aclassperipheral_1_1_a_d_c_html_a9d9ed0614da18b7f52ce01fcc59b9c78"><div class="ttname"><a href="classperipheral_1_1_a_d_c.html#a9d9ed0614da18b7f52ce01fcc59b9c78">peripheral::ADC::config</a></div><div class="ttdeci">bool config(std::vector&lt; uint8_t &gt; channels, uint8_t sampleTime, std::size_t dmaBuffSizePerChannel)</div><div class="ttdoc">初期化</div><div class="ttdef"><b>Definition:</b> <a href="_a_d_c__impl_8hpp_source.html#l00019">ADC_impl.hpp:19</a></div></div>
<div class="ttc" id="aclassperipheral_1_1_a_d_c_html_aef96113602ede49aee71124ef247442d"><div class="ttname"><a href="classperipheral_1_1_a_d_c.html#aef96113602ede49aee71124ef247442d">peripheral::ADC::readVoltage</a></div><div class="ttdeci">std::optional&lt; float &gt; readVoltage(uint8_t ch) const</div><div class="ttdoc">電圧の取得</div><div class="ttdef"><b>Definition:</b> <a href="_a_d_c__impl_8hpp_source.html#l00053">ADC_impl.hpp:53</a></div></div>
<div class="ttc" id="agroup___a_d_c__channels_html_ga0b04cebf8d62085eca6dc7daa3d5d3f0"><div class="ttname"><a href="group___a_d_c__channels.html#ga0b04cebf8d62085eca6dc7daa3d5d3f0">ADC_Channel_1</a></div><div class="ttdeci">#define ADC_Channel_1</div><div class="ttdef"><b>Definition:</b> <a href="stm32f4xx__adc_8h_source.html#l00309">stm32f4xx_adc.h:309</a></div></div>
<div class="ttc" id="agroup___a_d_c__channels_html_ga40ec353803e9470a5721ef5bf0b1ab24"><div class="ttname"><a href="group___a_d_c__channels.html#ga40ec353803e9470a5721ef5bf0b1ab24">ADC_Channel_0</a></div><div class="ttdeci">#define ADC_Channel_0</div><div class="ttdef"><b>Definition:</b> <a href="stm32f4xx__adc_8h_source.html#l00308">stm32f4xx_adc.h:308</a></div></div>
<div class="ttc" id="agroup___a_d_c__sampling__times_html_ga7b89fd620d7f7d361a9e7af3713cca0e"><div class="ttname"><a href="group___a_d_c__sampling__times.html#ga7b89fd620d7f7d361a9e7af3713cca0e">ADC_SampleTime_3Cycles</a></div><div class="ttdeci">#define ADC_SampleTime_3Cycles</div><div class="ttdef"><b>Definition:</b> <a href="stm32f4xx__adc_8h_source.html#l00366">stm32f4xx_adc.h:366</a></div></div>
<div class="ttc" id="anamespace_f4_html_a49f4802b0785451687f484d77f0d1829"><div class="ttname"><a href="namespace_f4.html#a49f4802b0785451687f484d77f0d1829">F4::adc1</a></div><div class="ttdeci">constexpr auto adc1</div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___s_t_m___f4_lib_2_a_d_c_8hpp_source.html#l00050">ADC.hpp:50</a></div></div>
<div class="ttc" id="anamespacemother_html_ab6f2a3687895c34bf49fa9acdaa2c0d7"><div class="ttname"><a href="namespacemother.html#ab6f2a3687895c34bf49fa9acdaa2c0d7">mother::adc</a></div><div class="ttdeci">F4::ADC adc</div><div class="ttdef"><b>Definition:</b> <a href="_running_board_8cpp_source.html#l00044">RunningBoard.cpp:44</a></div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md732"></a>
TIM</h1>
<p >TIMに関する基本的な機能を提供します</p>
<p >TIMは様々な目的で使用されるので、otherモジュールにそれ用のクラスが定義されています(<a class="el" href="classrur_1_1_p_w_m.html" title="TIM, GPIOの正しい継承になっていないときにを継承してないときにマッチするやつ  正しいクラスの時はSFINAEによって下のやつにマッチする">rur::PWM</a>, rur:Encoder等) そちらのドキュメントも参照してください</p>
<p >参照</p>
<ul>
<li><code><a class="el" href="classperipheral_1_1_t_i_m.html" title="TIMクラス">peripheral::TIM</a>&lt;Method&gt;</code></li>
</ul>
<h2><a class="anchor" id="autotoc_md733"></a>
共通の初期化</h2>
<div class="fragment"><div class="line"><span class="comment">// TIM1を100kHzで初期化</span></div>
<div class="line"><a class="code hl_class" href="classperipheral_1_1_t_i_m.html">F4::TIM</a> tim(F4::TimerClockParameter::generate&lt;F4::tim1, 100000&gt;());</div>
<div class="line">tim.config();</div>
<div class="ttc" id="aclassperipheral_1_1_t_i_m_html"><div class="ttname"><a href="classperipheral_1_1_t_i_m.html">peripheral::TIM&lt; TIMMethod &gt;</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md734"></a>
割り込みの初期化</h2>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> handler() {</div>
<div class="line">    led.toggle();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 割り込み初期化</span></div>
<div class="line">tim.configIT(<a class="code hl_enumvalue" href="namespaceperipheral_1_1tim.html#afdbda3800133f209ab3f51307cdafed9a3ac340832f29c11538fbe2d6f75e8bcc">F4::TIM::InterruptMode::update</a>, 0, handler);</div>
<div class="line">tim.setStart(<span class="keyword">true</span>);</div>
<div class="ttc" id="anamespaceperipheral_1_1tim_html_afdbda3800133f209ab3f51307cdafed9a3ac340832f29c11538fbe2d6f75e8bcc"><div class="ttname"><a href="namespaceperipheral_1_1tim.html#afdbda3800133f209ab3f51307cdafed9a3ac340832f29c11538fbe2d6f75e8bcc">peripheral::tim::InterruptMode::update</a></div><div class="ttdeci">@ update</div><div class="ttdoc">update</div></div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// 割り込み初期化 第三引数はラムダでも可(std::function&lt;void()&gt;ならなんでも)</span></div>
<div class="line">tim.configIT(<a class="code hl_enumvalue" href="namespaceperipheral_1_1tim.html#afdbda3800133f209ab3f51307cdafed9a3ac340832f29c11538fbe2d6f75e8bcc">F4::TIM::InterruptMode::update</a>, 0, [&amp;]{led.toggle();});</div>
<div class="line">tim.setStart(<span class="keyword">true</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md735"></a>
OC出力の初期化</h2>
<div class="fragment"><div class="line"><span class="comment">// アウトプットコンペア初期化</span></div>
<div class="line">tim.configOC(F4::TIM::Ch::_1);</div>
<div class="line">F4::TIM::Channel ch = tim.createChannel(F4::TIM::Ch::_1);</div>
<div class="line"> </div>
<div class="line">tim.setStart(<span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// duty比50%のPWM出力</span></div>
<div class="line"><span class="comment">// これ以外に、GPIOピンの出力、AFの初期化が必要 詳しくは↓</span></div>
<div class="line">ch.setCompare(ch.getPeriod() * 0.5);</div>
<div class="line">ch.setEnable(<span class="keyword">true</span>);</div>
</div><!-- fragment --><p >PWM出力はTIM以外にもいろいろいじらないといけないのでotherモジュールのPWM、Servoクラスにまとめてある</p>
<h2><a class="anchor" id="autotoc_md736"></a>
PWM</h2>
<p >参照</p>
<ul>
<li><a class="el" href="classrur_1_1_p_w_m.html" title="TIM, GPIOの正しい継承になっていないときにを継承してないときにマッチするやつ  正しいクラスの時はSFINAEによって下のやつにマッチする">rur::PWM</a></li>
</ul>
<div class="fragment"><div class="line"><span class="comment">// TIM1を100kHzで初期化</span></div>
<div class="line"><a class="code hl_class" href="classperipheral_1_1_t_i_m.html">F4::TIM</a> tim(F4::TimerClockParameter::generate&lt;F4::tim1, 100000&gt;());</div>
<div class="line"> </div>
<div class="line">tim.config();</div>
<div class="line"><a class="code hl_class" href="classrur_1_1_p_w_m.html">F4::PWM</a> pwm, complementaryPWM;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// ch1を単相PWMで初期化</span></div>
<div class="line">tim.configOC(F4::TIM::Ch::_1);</div>
<div class="line">pwm.config(tim.createChannel(F4::TIM::Ch::_1), <a class="code hl_function" href="namespace_f4.html#a620bd37fd0def2357be6a1135f1bd12c">F4::PA8</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// ch2を相補PWMで初期化</span></div>
<div class="line">tim.configOC(F4::TIM::Ch::_2, F4::TIM::PWMMode::complementary);</div>
<div class="line">complementaryPWM.config(tim.createChannel(F4::TIM::Ch::_2), <a class="code hl_function" href="namespace_f4.html#ada50592fb568bbcf954bb558319bcc8d">F4::PA9</a>, <a class="code hl_function" href="namespace_f4.html#ababa17352bfc6a3be6d02b267f13fb71">F4::PE11</a>);</div>
<div class="line"> </div>
<div class="line">tim.setStart(<span class="keyword">true</span>);</div>
<div class="line">pwm.setEnable(<span class="keyword">true</span>);</div>
<div class="line">complementaryPWM.setEnable(<span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">pwm.setDuty(0.5f); <span class="comment">// H:L = 1:1</span></div>
<div class="line">complementaryPWM.setDuty(0.5f) <span class="comment">// H:L = 3:1</span></div>
<div class="ttc" id="aclassrur_1_1_p_w_m_html"><div class="ttname"><a href="classrur_1_1_p_w_m.html">rur::PWM&lt; TIMMethod, GPIOMethod &gt;</a></div></div>
<div class="ttc" id="anamespace_f4_html_a620bd37fd0def2357be6a1135f1bd12c"><div class="ttname"><a href="namespace_f4.html#a620bd37fd0def2357be6a1135f1bd12c">F4::PA8</a></div><div class="ttdeci">constexpr Pin PA8(GPIOA_BASE, GPIO_Pin_8)</div></div>
<div class="ttc" id="anamespace_f4_html_ababa17352bfc6a3be6d02b267f13fb71"><div class="ttname"><a href="namespace_f4.html#ababa17352bfc6a3be6d02b267f13fb71">F4::PE11</a></div><div class="ttdeci">constexpr Pin PE11(GPIOE_BASE, GPIO_Pin_11)</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md737"></a>
Servo</h2>
<p >参照</p>
<ul>
<li><a class="el" href="classrur_1_1_servo.html" title="TIM, GPIOの正しい継承になっていないときにを継承してないときにマッチするやつ  正しいクラスの時はSFINAEによって下のやつにマッチする">rur::Servo</a></li>
</ul>
<div class="fragment"><div class="line"><span class="comment">// tim1を　50Hz(20ms周期) ピリオド20&#39;000で初期化</span></div>
<div class="line"><a class="code hl_class" href="classperipheral_1_1_t_i_m.html">F4::TIM</a> tim(F4::TimerClockParameter::generate&lt;F4::tim1, 50, 20000&gt;());</div>
<div class="line">tim.config();</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classrur_1_1_servo.html">F4::Servo</a> servo;</div>
<div class="line"> </div>
<div class="line">tim.configOC(F4::TIM::Ch::_1);</div>
<div class="line">servo.config(tim.createChannel(F4::TIM::Ch::_1), <a class="code hl_function" href="namespace_f4.html#a620bd37fd0def2357be6a1135f1bd12c">F4::PA8</a>);</div>
<div class="line"> </div>
<div class="line">tim.setStart(<span class="keyword">true</span>);</div>
<div class="line">servo.setEnable(<span class="keyword">true</span>);</div>
<div class="line">servo.setPulseWidth(1500); <span class="comment">// 1500usec pulse</span></div>
<div class="ttc" id="aclassrur_1_1_servo_html"><div class="ttname"><a href="classrur_1_1_servo.html">rur::Servo</a></div><div class="ttdoc">TIM, GPIOの正しい継承になっていないときにを継承してないときにマッチするやつ  正しいクラスの時はSFINAEによって下のやつにマッチする</div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___s_t_m___periph_lib_2other_2_servo_8hpp_source.html#l00028">Servo.hpp:28</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md738"></a>
Encoder</h2>
<p >参照</p>
<ul>
<li><a class="el" href="classrur_1_1_encoder.html" title="TIM, GPIOの正しい継承になっていないときにを継承してないときにマッチするやつ  正しいクラスの時はSFINAEによって下のやつにマッチする">rur::Encoder</a></li>
</ul>
<p >Encoderは1つでTIMを1つ使うため、PWM等とは違ってotherモジュールのみで動作します</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classrur_1_1_encoder.html">F4::Encoder</a> enc{<a class="code hl_variable" href="namespace_f4.html#afaa93c2f73b0cfa918126f09592cb675">F4::tim1</a>, <a class="code hl_function" href="namespace_f4.html#a620bd37fd0def2357be6a1135f1bd12c">F4::PA8</a>, <a class="code hl_function" href="namespace_f4.html#ada50592fb568bbcf954bb558319bcc8d">F4::PA9</a>};</div>
<div class="line">enc.config();</div>
<div class="line"> </div>
<div class="line">enc.setPulsePerRound(500);</div>
<div class="line"> </div>
<div class="line">enc.updateIntegratedValue();</div>
<div class="line"><span class="keywordtype">float</span> value = enc.getIntegratedNormalizedValue();</div>
<div class="ttc" id="aclassrur_1_1_encoder_html"><div class="ttname"><a href="classrur_1_1_encoder.html">rur::Encoder</a></div><div class="ttdoc">TIM, GPIOの正しい継承になっていないときにを継承してないときにマッチするやつ  正しいクラスの時はSFINAEによって下のやつにマッチする</div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___s_t_m___periph_lib_2other_2_encoder_8hpp_source.html#l00029">Encoder.hpp:29</a></div></div>
<div class="ttc" id="anamespace_f4_html_afaa93c2f73b0cfa918126f09592cb675"><div class="ttname"><a href="namespace_f4.html#afaa93c2f73b0cfa918126f09592cb675">F4::tim1</a></div><div class="ttdeci">constexpr auto tim1</div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___s_t_m___f4_lib_2_t_i_m_8hpp_source.html#l00098">TIM.hpp:98</a></div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md740"></a>
基板</h1>
<p >基板ごとにその基盤の機能にアクセスできるヘッダがあると便利です</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>nucleo {</div>
<div class="line"><span class="keyword">constexpr</span> <span class="keyword">auto</span> led1 = <a class="code hl_function" href="namespace_f4.html#a0dcc7d58d3cf6ff12b7d3649d619d265">F4::PA5</a>;</div>
<div class="line"><span class="keyword">constexpr</span> <span class="keyword">auto</span> button = <a class="code hl_function" href="namespace_f4.html#a20faaaad82735c1216273e9114ac86d4">F4::PC13</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> <span class="keyword">auto</span> usbUart = <a class="code hl_variable" href="namespace_f4.html#aa7e29c3126455e39f831e85ca57b2238">F4::uart2</a>;</div>
<div class="line"><span class="keyword">constexpr</span> <span class="keyword">auto</span> usbUartTx = <a class="code hl_function" href="namespace_f4.html#a9a66e9e6f034bb3434c3c3a1bab94680">F4::PA2</a>;</div>
<div class="line"><span class="keyword">constexpr</span> <span class="keyword">auto</span> usbUartRx = <a class="code hl_function" href="namespace_f4.html#aa2456952c1575aa821d0cffb8b2b0165">F4::PA3</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>Board {</div>
<div class="line">    <a class="code hl_class" href="classrur_1_1_l_e_d.html">F4::LED</a> led = nucleo::led1;</div>
<div class="line">    <a class="code hl_class" href="classrur_1_1_push_sensor.html">F4::PushSensor</a> button = nucleo::button;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classperipheral_1_1_u_a_r_t.html">F4::UART</a> <a class="code hl_variable" href="namespacemother.html#a2e39e33cbdb9ec863e21cb818ec66cf2">serial</a> = nucleo::usbUart;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classperipheral_1_1_a_d_c_1_1_channel.html">F4::ADC::Channel</a> analog;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <a class="code hl_class" href="classperipheral_1_1_a_d_c.html">F4::ADC</a> <a class="code hl_variable" href="namespacemother.html#ab6f2a3687895c34bf49fa9acdaa2c0d7">adc</a> = <a class="code hl_variable" href="namespace_f4.html#a49f4802b0785451687f484d77f0d1829">F4::adc1</a>;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">constexpr</span> uint8_t <a class="code hl_variable" href="namespacemother.html#abb20880eadca68821a5be8eb5f996e1d">adcCh</a> = <a class="code hl_define" href="group___a_d_c__channels.html#ga40ec353803e9470a5721ef5bf0b1ab24">ADC_Channel_0</a>;</div>
<div class="line"> </div>
<div class="line">    ...</div>
<div class="line"> </div>
<div class="line">public:</div>
<div class="line">    <span class="keywordtype">void</span> config() {</div>
<div class="line">        led.config();</div>
<div class="line">        button.config();</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_variable" href="namespacemother.html#a2e39e33cbdb9ec863e21cb818ec66cf2">serial</a>.<a class="code hl_function" href="classperipheral_1_1_u_a_r_t.html#ab8bef3cae83311766725310d459025c1">config</a>(nucleo::usbUartTx, nucleo::usbUartRx);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_variable" href="namespacemother.html#ab6f2a3687895c34bf49fa9acdaa2c0d7">adc</a>.<a class="code hl_function" href="classperipheral_1_1_a_d_c.html#a9d9ed0614da18b7f52ce01fcc59b9c78">config</a>({<a class="code hl_variable" href="namespacemother.html#abb20880eadca68821a5be8eb5f996e1d">adcCh</a>}, <a class="code hl_define" href="group___a_d_c__sampling__times.html#ga7b89fd620d7f7d361a9e7af3713cca0e">ADC_SampleTime_3Cycles</a>);</div>
<div class="line">        <a class="code hl_enumvalue" href="namespaceperipheral_1_1gpio.html#ad225668bde900c93eaff27c38e3fd2e9a02c9adc0d63e270f7ea08ef4008e81bf">analog</a> = *<a class="code hl_variable" href="namespacemother.html#ab6f2a3687895c34bf49fa9acdaa2c0d7">adc</a>.<a class="code hl_function" href="classperipheral_1_1_a_d_c.html#a3eb481491802c74ecec2ee5ce85c96b4">createChannel</a>(<a class="code hl_variable" href="namespacemother.html#abb20880eadca68821a5be8eb5f996e1d">adcCh</a>);</div>
<div class="line"> </div>
<div class="line">        ...</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">Board <a class="code hl_namespace" href="namespaceboard.html">board</a>;</div>
<div class="line"><a class="code hl_namespace" href="namespaceboard.html">board</a>.config();</div>
<div class="line"> </div>
<div class="line"><a class="code hl_namespace" href="namespaceboard.html">board</a>.<a class="code hl_namespace" href="namespaceboard_1_1led.html">led</a>.on();</div>
<div class="ttc" id="anamespace_f4_html_a0dcc7d58d3cf6ff12b7d3649d619d265"><div class="ttname"><a href="namespace_f4.html#a0dcc7d58d3cf6ff12b7d3649d619d265">F4::PA5</a></div><div class="ttdeci">constexpr Pin PA5(GPIOA_BASE, GPIO_Pin_5)</div></div>
<div class="ttc" id="anamespace_f4_html_a20faaaad82735c1216273e9114ac86d4"><div class="ttname"><a href="namespace_f4.html#a20faaaad82735c1216273e9114ac86d4">F4::PC13</a></div><div class="ttdeci">constexpr Pin PC13(GPIOC_BASE, GPIO_Pin_13)</div></div>
<div class="ttc" id="anamespace_f4_html_a9a66e9e6f034bb3434c3c3a1bab94680"><div class="ttname"><a href="namespace_f4.html#a9a66e9e6f034bb3434c3c3a1bab94680">F4::PA2</a></div><div class="ttdeci">constexpr Pin PA2(GPIOA_BASE, GPIO_Pin_2)</div></div>
<div class="ttc" id="anamespace_f4_html_aa2456952c1575aa821d0cffb8b2b0165"><div class="ttname"><a href="namespace_f4.html#aa2456952c1575aa821d0cffb8b2b0165">F4::PA3</a></div><div class="ttdeci">constexpr Pin PA3(GPIOA_BASE, GPIO_Pin_3)</div></div>
<div class="ttc" id="anamespace_f4_html_aa7e29c3126455e39f831e85ca57b2238"><div class="ttname"><a href="namespace_f4.html#aa7e29c3126455e39f831e85ca57b2238">F4::uart2</a></div><div class="ttdeci">constexpr auto uart2</div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___s_t_m___f4_lib_2_u_a_r_t_8hpp_source.html#l00055">UART.hpp:55</a></div></div>
<div class="ttc" id="anamespaceboard_1_1led_html"><div class="ttname"><a href="namespaceboard_1_1led.html">board::led</a></div><div class="ttdef"><b>Definition:</b> <a href="_r_u_r___c_a_n_board___base_2interface_2_l_e_d_8hpp_source.html#l00019">LED.hpp:20</a></div></div>
<div class="ttc" id="anamespaceboard_html"><div class="ttname"><a href="namespaceboard.html">board</a></div><div class="ttdef"><b>Definition:</b> <a href="_controller_8hpp_source.html#l00018">Controller.hpp:19</a></div></div>
<div class="ttc" id="anamespacemother_html_abb20880eadca68821a5be8eb5f996e1d"><div class="ttname"><a href="namespacemother.html#abb20880eadca68821a5be8eb5f996e1d">mother::adcCh</a></div><div class="ttdeci">std::vector&lt; uint8_t &gt; adcCh</div><div class="ttdef"><b>Definition:</b> <a href="_running_board_8cpp_source.html#l00046">RunningBoard.cpp:46</a></div></div>
<div class="ttc" id="anamespaceperipheral_1_1gpio_html_ad225668bde900c93eaff27c38e3fd2e9a02c9adc0d63e270f7ea08ef4008e81bf"><div class="ttname"><a href="namespaceperipheral_1_1gpio.html#ad225668bde900c93eaff27c38e3fd2e9a02c9adc0d63e270f7ea08ef4008e81bf">peripheral::gpio::Mode::analog</a></div><div class="ttdeci">@ analog</div><div class="ttdoc">アナログ入力モード</div></div>
</div><!-- fragment --><p ><a href="https://cpprefjp.github.io/lang/cpp17/inline_variables.html">インライン変数</a>を用いることでBoardのインスタンスを生成する必要が無くなり, ヘッダオンリーで済ませられます(グローバル変数と紙一重だが、一つしか存在し得ないインスタンスなので、まあ(Singletonもありっちゃアリだけど、好みとかの問題な気もする))</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>nucleo {</div>
<div class="line"><span class="keyword">constexpr</span> <span class="keyword">auto</span> led1 = <a class="code hl_function" href="namespace_f4.html#a0dcc7d58d3cf6ff12b7d3649d619d265">F4::PA5</a>;</div>
<div class="line"><span class="keyword">constexpr</span> <span class="keyword">auto</span> button = <a class="code hl_function" href="namespace_f4.html#a20faaaad82735c1216273e9114ac86d4">F4::PC13</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> <span class="keyword">auto</span> usbUart = <a class="code hl_variable" href="namespace_f4.html#aa7e29c3126455e39f831e85ca57b2238">F4::uart2</a>;</div>
<div class="line"><span class="keyword">constexpr</span> <span class="keyword">auto</span> usbUartTx = <a class="code hl_function" href="namespace_f4.html#a9a66e9e6f034bb3434c3c3a1bab94680">F4::PA2</a>;</div>
<div class="line"><span class="keyword">constexpr</span> <span class="keyword">auto</span> usbUartRx = <a class="code hl_function" href="namespace_f4.html#aa2456952c1575aa821d0cffb8b2b0165">F4::PA3</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>Board {</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code hl_class" href="classrur_1_1_l_e_d.html">F4::LED</a> led = nucleo::led1;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code hl_class" href="classrur_1_1_push_sensor.html">F4::PushSensor</a> button = nucleo::button;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code hl_class" href="classperipheral_1_1_u_a_r_t.html">F4::UART</a> <a class="code hl_variable" href="namespacemother.html#a2e39e33cbdb9ec863e21cb818ec66cf2">serial</a> = nucleo::usbUart;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code hl_class" href="classperipheral_1_1_a_d_c_1_1_channel.html">F4::ADC::Channel</a> analog;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code hl_class" href="classperipheral_1_1_a_d_c.html">F4::ADC</a> <a class="code hl_variable" href="namespacemother.html#ab6f2a3687895c34bf49fa9acdaa2c0d7">adc</a> = <a class="code hl_variable" href="namespace_f4.html#a49f4802b0785451687f484d77f0d1829">F4::adc1</a>;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">constexpr</span> uint8_t <a class="code hl_variable" href="namespacemother.html#abb20880eadca68821a5be8eb5f996e1d">adcCh</a> = <a class="code hl_define" href="group___a_d_c__channels.html#ga40ec353803e9470a5721ef5bf0b1ab24">ADC_Channel_0</a>;</div>
<div class="line"> </div>
<div class="line">    ...</div>
<div class="line"> </div>
<div class="line">public:</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span> config() {</div>
<div class="line">        led.config();</div>
<div class="line">        button.config();</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_variable" href="namespacemother.html#a2e39e33cbdb9ec863e21cb818ec66cf2">serial</a>.<a class="code hl_function" href="classperipheral_1_1_u_a_r_t.html#ab8bef3cae83311766725310d459025c1">config</a>(nucleo::usbUartTx, nucleo::usbUartRx);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_variable" href="namespacemother.html#ab6f2a3687895c34bf49fa9acdaa2c0d7">adc</a>.<a class="code hl_function" href="classperipheral_1_1_a_d_c.html#a9d9ed0614da18b7f52ce01fcc59b9c78">config</a>({<a class="code hl_variable" href="namespacemother.html#abb20880eadca68821a5be8eb5f996e1d">adcCh</a>}, <a class="code hl_define" href="group___a_d_c__sampling__times.html#ga7b89fd620d7f7d361a9e7af3713cca0e">ADC_SampleTime_3Cycles</a>);</div>
<div class="line">        <a class="code hl_enumvalue" href="namespaceperipheral_1_1gpio.html#ad225668bde900c93eaff27c38e3fd2e9a02c9adc0d63e270f7ea08ef4008e81bf">analog</a> = *<a class="code hl_variable" href="namespacemother.html#ab6f2a3687895c34bf49fa9acdaa2c0d7">adc</a>.<a class="code hl_function" href="classperipheral_1_1_a_d_c.html#a3eb481491802c74ecec2ee5ce85c96b4">createChannel</a>(<a class="code hl_variable" href="namespacemother.html#abb20880eadca68821a5be8eb5f996e1d">adcCh</a>);</div>
<div class="line"> </div>
<div class="line">        ...</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">Board::config();</div>
<div class="line"> </div>
<div class="line">Board::led.on();</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
